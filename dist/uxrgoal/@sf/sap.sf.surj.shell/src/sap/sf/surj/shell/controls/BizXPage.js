jQuery.sap.declare("sap.sf.surj.shell.controls.BizXPage");jQuery.sap.require("sap.sf.surj.shell.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.sf.surj.shell.controls.BizXPage",{metadata:{library:"sap.sf.surj.shell"}});sap.ui.define('sap/sf/surj/shell/controls/BizXPage',['jquery.sap.global','sap/m/Page','sap/m/PageAccessibleLandmarkInfo','sap/sf/surj/shell/util/DeferredUtil','sap/ui/core/ComponentContainer','./Container'],function($,P,a,D,C,b){"use strict";var c=["insightsPlacematIcon","showMePlacematIcon"];return P.extend('sap.sf.surj.shell.controls.BizXPage',{metadata:{library:'sap.sf.surj.shell',properties:{fullHeight:'boolean',containerCSS:'string',placematCSS:'string'},aggregations:{customHeader:{type:'sap.ui.core.Control',multiple:false},placematButtons:{type:'sap.m.Button',multiple:true},_placematIcons:{visibility:'hidden',type:'sap.ui.core.Control',multiple:false},footer:{type:'sap.ui.core.Control',multiple:false}},events:{heightAdjusted:{}}},renderer:function(r,p){var t=p.getTooltip_AsString();var s=p.getContainerCSS();var d=p.getPlacematCSS();var l=p.getLandmarkInfo();r.write('<div');r.writeControlData(p);r.addClass('sapMPage');r.addClass('bizXPage');if(p.getFullHeight()){r.addClass('bizXFullHeight');}r.writeClasses();if(t){r.writeAttributeEscaped('title',t);}if(a._writeLandmarkInfo){a._writeLandmarkInfo(r,p,'root');}else if(p._formatLandmarkInfo){r.writeAccessibilityState(p,p._formatLandmarkInfo(l,"Root"));}r.write('>');r.write('<section id="'+p.getId()+'-cont">');r.write('<div id="globalHeaderFullWidthBackground" class="globalHeaderFullWidthBackground"></div>');r.write('<div class="globalLighting1"><div class="globalLighting2"><div class="bizXContent"');if(s){r.write(' style="',s,'"');}r.write('>');r.renderControl(p.getCustomHeader());r.write('<div id="content" role="main" class="globalPlacemat"');if(d){r.write(' style="',d,'"');}r.write('>');r.renderControl(p.getAggregation('_placematIcons'));r.write('<div class="bizXPageContentParent">');$.each(p.getContent()||[],function(){r.renderControl(this);});r.write('</div></div>');r.renderControl(p.getFooter());r.write('</div></div></div>');r.write('</section>');r.write('</div>');},init:function(){this._adjustFullHeight=$.proxy(this._adjustFullHeight,this);P.prototype.init&&P.prototype.init.apply(this,arguments);this._aOrderedPlacematIconIndexs=[];this._oHeaderRendered=$.Deferred();this.setAggregation('_placematIcons',new b().addStyleClass('placematIcons'));},addPlacematButton:function(p){p.addStyleClass('globalToolbarIcon');var I=p.getId();var d=c.indexOf(I);var o=this._aOrderedPlacematIconIndexs;var e;var f;for(var i=0,l=o.length;i<l;i++){var g=o[i];if(g>d){e=f=i;break;}}if(isNaN(e)){e=o.length;f=-1;}this._aOrderedPlacematIconIndexs.splice(e,0,f);this.getAggregation('_placematIcons').insertAggregation('content',p,e);setTimeout(this._adjustFullHeight.bind(this),0);},onAfterRendering:function(){var p=P.prototype.onAfterRendering;p&&p.apply(this,arguments);if(this.getFullHeight()){$(window).bind('resize',this._adjustFullHeight);var t=this;$.when(D.whenUI5LibraryCSSReady(),this._oHeaderRendered).done(function(){setTimeout(function(){t._adjustFullHeight();},0);});}else{var s=this.$('cont');var B=$('html, html body, .globalBackground, .globalLighting1, .globalLighting2');s.scroll(function(){B.css('background-position-y',-s.scrollTop()+'px');});}},destroy:function(){P.prototype.destroy.apply(this,arguments);$(window).unbind('resize',this._adjustFullHeight);},setCustomHeader:function(h){function _(o){o.addEventDelegate({onAfterRendering:function(){H.resolve();}});}P.prototype.setCustomHeader.apply(this,arguments);var H=this._oHeaderRendered;if(h&&h.attachComponentCreated){h.attachComponentCreated(function(e){var o=e.getParameter("component").getRootControl();_(o);})}else if(h instanceof sap.ui.core.Control){_(h);}},_adjustFullHeight:function(){if(!this.getFullHeight()){return;}var p=$('#content');var d=p.parent()[0];if(d.scrollHeight>0){p.css('height','');if(this.getAggregation('_placematIcons').getContent().length){var e=p.find('.bizXPageContentParent');var f=p.find('.placematIcons');e.css({height:"calc(100% - "+f.innerHeight()+"px)"});}var g=d.scrollHeight-d.offsetHeight;var t=parseFloat(p.css('borderTopWidth'));var h=parseFloat(p.css('borderTopWidth'));p.css('height',(p.innerHeight()-g+t+h)+'px');this.fireHeightAdjusted();}}});});
